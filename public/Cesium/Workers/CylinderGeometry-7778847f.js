define(["exports","./GeometryOffsetAttribute-def3b741","./Transforms-a73b3b3b","./Cartesian2-8417ca3d","./ComponentDatatype-9204e9f6","./CylinderGeometryLibrary-daf6cec5","./when-208fe5b0","./Check-d18af7c4","./GeometryAttribute-04a19cfe","./GeometryAttributes-b0b294d8","./IndexDatatype-d47ad6f6","./Math-4e53b694","./VertexFormat-e8cbf5b3"],(function(t,e,a,r,n,o,i,s,m,u,d,f,p){"use strict";var y=new r.Cartesian2,l=new r.Cartesian3,b=new r.Cartesian3,c=new r.Cartesian3,v=new r.Cartesian3;function A(t){var e=(t=i.defaultValue(t,i.defaultValue.EMPTY_OBJECT)).length,a=t.topRadius,r=t.bottomRadius,n=i.defaultValue(t.vertexFormat,p.VertexFormat.DEFAULT),o=i.defaultValue(t.slices,128);this._length=e,this._topRadius=a,this._bottomRadius=r,this._vertexFormat=p.VertexFormat.clone(n),this._slices=o,this._offsetAttribute=t.offsetAttribute,this._workerName="createCylinderGeometry"}A.packedLength=p.VertexFormat.packedLength+5,A.pack=function(t,e,a){return a=i.defaultValue(a,0),p.VertexFormat.pack(t._vertexFormat,e,a),a+=p.VertexFormat.packedLength,e[a++]=t._length,e[a++]=t._topRadius,e[a++]=t._bottomRadius,e[a++]=t._slices,e[a]=i.defaultValue(t._offsetAttribute,-1),e};var g,h=new p.VertexFormat,x={vertexFormat:h,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};A.unpack=function(t,e,a){e=i.defaultValue(e,0);var r=p.VertexFormat.unpack(t,e,h);e+=p.VertexFormat.packedLength;var n=t[e++],o=t[e++],s=t[e++],m=t[e++];e=t[e];return i.defined(a)?(a._vertexFormat=p.VertexFormat.clone(r,a._vertexFormat),a._length=n,a._topRadius=o,a._bottomRadius=s,a._slices=m,a._offsetAttribute=-1===e?void 0:e,a):(x.length=n,x.topRadius=o,x.bottomRadius=s,x.slices=m,x.offsetAttribute=-1===e?void 0:e,new A(x))},A.createGeometry=function(t){var s=t._length,p=t._topRadius,A=t._bottomRadius,g=t._vertexFormat,h=t._slices;if(!(s<=0||p<0||A<0||0===p&&0===A)){var x=h+h,_=h+x,C=x+x,F=o.CylinderGeometryLibrary.computePositions(s,p,A,h,!0),w=g.st?new Float32Array(2*C):void 0,G=g.normal?new Float32Array(3*C):void 0,D=g.tangent?new Float32Array(3*C):void 0,R=g.bitangent?new Float32Array(3*C):void 0,V=g.normal||g.tangent||g.bitangent;if(V){var T=g.tangent||g.bitangent,O=0,L=0,P=0,k=Math.atan2(A-p,s),M=l;M.z=Math.sin(k);for(var z=Math.cos(k),E=c,N=b,I=0;I<h;I++){var U=I/h*f.CesiumMath.TWO_PI,S=z*Math.cos(U);U=z*Math.sin(U);V&&(M.x=S,M.y=U,T&&(E=r.Cartesian3.normalize(r.Cartesian3.cross(r.Cartesian3.UNIT_Z,M,E),E)),g.normal&&(G[O++]=M.x,G[O++]=M.y,G[O++]=M.z,G[O++]=M.x,G[O++]=M.y,G[O++]=M.z),g.tangent&&(D[L++]=E.x,D[L++]=E.y,D[L++]=E.z,D[L++]=E.x,D[L++]=E.y,D[L++]=E.z),g.bitangent&&(N=r.Cartesian3.normalize(r.Cartesian3.cross(M,E,N),N),R[P++]=N.x,R[P++]=N.y,R[P++]=N.z,R[P++]=N.x,R[P++]=N.y,R[P++]=N.z))}for(I=0;I<h;I++)g.normal&&(G[O++]=0,G[O++]=0,G[O++]=-1),g.tangent&&(D[L++]=1,D[L++]=0,D[L++]=0),g.bitangent&&(R[P++]=0,R[P++]=-1,R[P++]=0);for(I=0;I<h;I++)g.normal&&(G[O++]=0,G[O++]=0,G[O++]=1),g.tangent&&(D[L++]=1,D[L++]=0,D[L++]=0),g.bitangent&&(R[P++]=0,R[P++]=1,R[P++]=0)}var B=d.IndexDatatype.createTypedArray(C,12*h-12),Y=0,Z=0;for(I=0;I<h-1;I++)B[Y++]=Z,B[Y++]=Z+2,B[Y++]=Z+3,B[Y++]=Z,B[Y++]=Z+3,B[Y++]=Z+1,Z+=2;for(B[Y++]=x-2,B[Y++]=0,B[Y++]=1,B[Y++]=x-2,B[Y++]=1,B[Y++]=x-1,I=1;I<h-1;I++)B[Y++]=x+I+1,B[Y++]=x+I,B[Y++]=x;for(I=1;I<h-1;I++)B[Y++]=_,B[Y++]=_+I,B[Y++]=_+I+1;var J=0;if(g.st){var W=Math.max(p,A);for(I=0;I<C;I++){var j=r.Cartesian3.fromArray(F,3*I,v);w[J++]=(j.x+W)/(2*W),w[J++]=(j.y+W)/(2*W)}}return k=new u.GeometryAttributes,g.position&&(k.position=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:F})),g.normal&&(k.normal=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:G})),g.tangent&&(k.tangent=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:D})),g.bitangent&&(k.bitangent=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:R})),g.st&&(k.st=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:w})),y.x=.5*s,y.y=Math.max(A,p),A=new a.BoundingSphere(r.Cartesian3.ZERO,r.Cartesian2.magnitude(y)),i.defined(t._offsetAttribute)&&(s=F.length,p=new Uint8Array(s/3),s=t._offsetAttribute===e.GeometryOffsetAttribute.NONE?0:1,e.arrayFill(p,s),k.applyOffset=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:p})),new m.Geometry({attributes:k,indices:B,primitiveType:m.PrimitiveType.TRIANGLES,boundingSphere:A,offsetAttribute:t._offsetAttribute})}},A.getUnitCylinder=function(){return g=i.defined(g)?g:A.createGeometry(new A({topRadius:1,bottomRadius:1,length:1,vertexFormat:p.VertexFormat.POSITION_ONLY}))},t.CylinderGeometry=A}));