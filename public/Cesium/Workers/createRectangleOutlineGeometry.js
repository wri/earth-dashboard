define(["./when-208fe5b0","./Cartesian2-8417ca3d","./GeometryOffsetAttribute-def3b741","./Transforms-a73b3b3b","./ComponentDatatype-9204e9f6","./Check-d18af7c4","./GeometryAttribute-04a19cfe","./GeometryAttributes-b0b294d8","./IndexDatatype-d47ad6f6","./Math-4e53b694","./PolygonPipeline-4d0ff0fe","./RectangleGeometryLibrary-b88eec5f","./RuntimeError-7f634f5d","./WebGLConstants-76bb35d1","./EllipsoidRhumbLine-28521929"],(function(e,t,i,a,r,n,o,l,u,s,p,d,c,f,g){"use strict";var h=new a.BoundingSphere,y=new a.BoundingSphere,b=new t.Cartesian3,m=new t.Rectangle;function _(e,t){var i=e._ellipsoid,a=t.height,n=t.width,s=t.northCap,p=a,c=2,f=0;e=4;s&&(--c,--p,f+=1,e-=2),(v=t.southCap)&&(--c,--p,f+=1,e-=2),f+=c*n+2*p-e;var g,h=new Float64Array(3*f),y=0,m=0,_=b;if(s)d.RectangleGeometryLibrary.computePosition(t,i,!1,m,0,_),h[y++]=_.x,h[y++]=_.y,h[y++]=_.z;else for(g=0;g<n;g++)d.RectangleGeometryLibrary.computePosition(t,i,!1,m,g,_),h[y++]=_.x,h[y++]=_.y,h[y++]=_.z;for(g=n-1,m=1;m<a;m++)d.RectangleGeometryLibrary.computePosition(t,i,!1,m,g,_),h[y++]=_.x,h[y++]=_.y,h[y++]=_.z;if(m=a-1,!v)for(g=n-2;0<=g;g--)d.RectangleGeometryLibrary.computePosition(t,i,!1,m,g,_),h[y++]=_.x,h[y++]=_.y,h[y++]=_.z;for(g=0,m=a-2;0<m;m--)d.RectangleGeometryLibrary.computePosition(t,i,!1,m,g,_),h[y++]=_.x,h[y++]=_.y,h[y++]=_.z;for(var v=h.length/3*2,E=u.IndexDatatype.createTypedArray(h.length/3,v),A=0,G=0;G<h.length/3-1;G++)E[A++]=G,E[A++]=G+1;return E[A++]=h.length/3-1,E[A++]=0,(v=new o.Geometry({attributes:new l.GeometryAttributes,primitiveType:o.PrimitiveType.LINES})).attributes.position=new o.GeometryAttribute({componentDatatype:r.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:h}),v.indices=E,v}function v(i){var a=(i=e.defaultValue(i,e.defaultValue.EMPTY_OBJECT)).rectangle,r=e.defaultValue(i.granularity,s.CesiumMath.RADIANS_PER_DEGREE),n=e.defaultValue(i.ellipsoid,t.Ellipsoid.WGS84),o=e.defaultValue(i.rotation,0),l=e.defaultValue(i.height,0),u=e.defaultValue(i.extrudedHeight,l);this._rectangle=t.Rectangle.clone(a),this._granularity=r,this._ellipsoid=n,this._surfaceHeight=Math.max(l,u),this._rotation=o,this._extrudedHeight=Math.min(l,u),this._offsetAttribute=i.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}v.packedLength=t.Rectangle.packedLength+t.Ellipsoid.packedLength+5,v.pack=function(i,a,r){return r=e.defaultValue(r,0),t.Rectangle.pack(i._rectangle,a,r),r+=t.Rectangle.packedLength,t.Ellipsoid.pack(i._ellipsoid,a,r),r+=t.Ellipsoid.packedLength,a[r++]=i._granularity,a[r++]=i._surfaceHeight,a[r++]=i._rotation,a[r++]=i._extrudedHeight,a[r]=e.defaultValue(i._offsetAttribute,-1),a};var E=new t.Rectangle,A=t.Ellipsoid.clone(t.Ellipsoid.UNIT_SPHERE),G={rectangle:E,ellipsoid:A,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};v.unpack=function(i,a,r){a=e.defaultValue(a,0);var n=t.Rectangle.unpack(i,a,E);a+=t.Rectangle.packedLength;var o=t.Ellipsoid.unpack(i,a,A);a+=t.Ellipsoid.packedLength;var l=i[a++],u=i[a++],s=i[a++],p=i[a++];a=i[a];return e.defined(r)?(r._rectangle=t.Rectangle.clone(n,r._rectangle),r._ellipsoid=t.Ellipsoid.clone(o,r._ellipsoid),r._surfaceHeight=u,r._rotation=s,r._extrudedHeight=p,r._offsetAttribute=-1===a?void 0:a,r):(G.granularity=l,G.height=u,G.rotation=s,G.extrudedHeight=p,G.offsetAttribute=-1===a?void 0:a,new v(G))};var R=new t.Cartographic;return v.createGeometry=function(t){var n=t._rectangle,l=t._ellipsoid,c=d.RectangleGeometryLibrary.computeOptions(n,t._granularity,t._rotation,0,m,R);if(!s.CesiumMath.equalsEpsilon(n.north,n.south,s.CesiumMath.EPSILON10)&&!s.CesiumMath.equalsEpsilon(n.east,n.west,s.CesiumMath.EPSILON10)){var f,g,b,v,E=t._surfaceHeight,A=t._extrudedHeight;return E=s.CesiumMath.equalsEpsilon(E,A,0,s.CesiumMath.EPSILON2)?((g=_(t,c)).attributes.position.values=p.PolygonPipeline.scaleToGeodeticHeight(g.attributes.position.values,E,l,!1),e.defined(t._offsetAttribute)&&(c=g.attributes.position.values.length,c=new Uint8Array(c/3),v=t._offsetAttribute===i.GeometryOffsetAttribute.NONE?0:1,i.arrayFill(c,v),g.attributes.applyOffset=new o.GeometryAttribute({componentDatatype:r.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:c})),a.BoundingSphere.fromRectangle3D(n,l,E)):(g=function(e,t){var i=e._surfaceHeight,a=e._extrudedHeight,r=e._ellipsoid,n=a,o=i,l=_(e,t),s=(a=t.height,i=t.width,(e=p.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,o,r,!1)).length);(o=new Float64Array(2*s)).set(e),n=p.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,n,r),o.set(n,s),l.attributes.position.values=o,r=t.northCap,n=t.southCap,t=4,r&&--t,n&&--t;t=2*(o.length/3+t);for(var d=u.IndexDatatype.createTypedArray(o.length/3,t),c=(s=o.length/6,0),f=0;f<s-1;f++)d[c++]=f,d[c++]=f+1,d[c++]=f+s,d[c++]=f+s+1;return d[c++]=s-1,d[c++]=0,d[c++]=s+s-1,d[c++]=s,d[c++]=0,d[c++]=s,a=r?a-1:(d[c++]=r=i-1,d[c++]=r+s,i+a-2),d[c++]=a,d[c++]=a+s,n||(d[c++]=a=i+a-1,d[c]=a+s),l.indices=d,l}(t,c),e.defined(t._offsetAttribute)&&(f=g.attributes.position.values.length/3,b=new Uint8Array(f),b=t._offsetAttribute===i.GeometryOffsetAttribute.TOP?i.arrayFill(b,1,0,f/2):(v=t._offsetAttribute===i.GeometryOffsetAttribute.NONE?0:1,i.arrayFill(b,v)),g.attributes.applyOffset=new o.GeometryAttribute({componentDatatype:r.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:b})),b=a.BoundingSphere.fromRectangle3D(n,l,E,y),A=a.BoundingSphere.fromRectangle3D(n,l,A,h),a.BoundingSphere.union(b,A)),new o.Geometry({attributes:g.attributes,indices:g.indices,primitiveType:o.PrimitiveType.LINES,boundingSphere:E,offsetAttribute:t._offsetAttribute})}},function(i,a){return(i=e.defined(a)?v.unpack(i,a):i)._ellipsoid=t.Ellipsoid.clone(i._ellipsoid),i._rectangle=t.Rectangle.clone(i._rectangle),v.createGeometry(i)}}));