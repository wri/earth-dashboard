define(["./when-208fe5b0","./Cartesian2-8417ca3d","./ArcType-dc1c5aee","./Transforms-a73b3b3b","./Color-b0d12252","./ComponentDatatype-9204e9f6","./Check-d18af7c4","./GeometryAttribute-04a19cfe","./GeometryAttributes-b0b294d8","./IndexDatatype-d47ad6f6","./Math-4e53b694","./PolylinePipeline-28f5feec","./RuntimeError-7f634f5d","./WebGLConstants-76bb35d1","./EllipsoidGeodesic-8015072b","./EllipsoidRhumbLine-28521929","./IntersectionTests-7d224a2f","./Plane-4aa8974d"],(function(e,o,t,r,a,l,i,n,s,p,d,f,y,c,u,h,C,T){"use strict";function g(r){var l=(r=e.defaultValue(r,e.defaultValue.EMPTY_OBJECT)).positions,i=r.colors,n=e.defaultValue(r.colorsPerVertex,!1);this._positions=l,this._colors=i,this._colorsPerVertex=n,this._arcType=e.defaultValue(r.arcType,t.ArcType.GEODESIC),this._granularity=e.defaultValue(r.granularity,d.CesiumMath.RADIANS_PER_DEGREE),this._ellipsoid=e.defaultValue(r.ellipsoid,o.Ellipsoid.WGS84),this._workerName="createSimplePolylineGeometry",l=1+l.length*o.Cartesian3.packedLength,l+=e.defined(i)?1+i.length*a.Color.packedLength:1,this.packedLength=l+o.Ellipsoid.packedLength+3}g.pack=function(t,r,l){var i;l=e.defaultValue(l,0);var n=t._positions,s=n.length;for(r[l++]=s,i=0;i<s;++i,l+=o.Cartesian3.packedLength)o.Cartesian3.pack(n[i],r,l);var p=t._colors;s=e.defined(p)?p.length:0;for(r[l++]=s,i=0;i<s;++i,l+=a.Color.packedLength)a.Color.pack(p[i],r,l);return o.Ellipsoid.pack(t._ellipsoid,r,l),l+=o.Ellipsoid.packedLength,r[l++]=t._colorsPerVertex?1:0,r[l++]=t._arcType,r[l]=t._granularity,r},g.unpack=function(t,r,l){r=e.defaultValue(r,0);for(var i=t[r++],n=new Array(i),s=0;s<i;++s,r+=o.Cartesian3.packedLength)n[s]=o.Cartesian3.unpack(t,r);var p=0<(i=t[r++])?new Array(i):void 0;for(s=0;s<i;++s,r+=a.Color.packedLength)p[s]=a.Color.unpack(t,r);var d=o.Ellipsoid.unpack(t,r);r+=o.Ellipsoid.packedLength;var f=1===t[r++],y=t[r++],c=t[r];return e.defined(l)?(l._positions=n,l._colors=p,l._ellipsoid=d,l._colorsPerVertex=f,l._arcType=y,l._granularity=c,l):new g({positions:n,colors:p,ellipsoid:d,colorsPerVertex:f,arcType:y,granularity:c})};var m=new Array(2),b=new Array(2),P={positions:m,height:b,ellipsoid:void 0,minDistance:void 0,granularity:void 0};return g.createGeometry=function(i){var y=i._positions,c=i._colors,u=i._colorsPerVertex,h=i._arcType,C=i._granularity,T=(i=i._ellipsoid,d.CesiumMath.chordLength(C,i.maximumRadius)),g=e.defined(c)&&!u,_=y.length,v=0;if(h===t.ArcType.GEODESIC||h===t.ArcType.RHUMB){var B,A,E=h===t.ArcType.GEODESIC?(B=d.CesiumMath.chordLength(C,i.maximumRadius),A=f.PolylinePipeline.numberOfPoints,f.PolylinePipeline.generateArc):(B=C,A=f.PolylinePipeline.numberOfPointsRhumbLine,f.PolylinePipeline.generateRhumbArc),k=f.PolylinePipeline.extractHeights(y,i),G=P;if(h===t.ArcType.GEODESIC?G.minDistance=T:G.granularity=C,G.ellipsoid=i,g){for(var w=0,D=0;D<_-1;D++)w+=A(y[D],y[D+1],B)+1;M=new Float64Array(3*w),U=new Uint8Array(4*w),G.positions=m,G.height=b;var L=0;for(D=0;D<_-1;++D){m[0]=y[D],m[1]=y[D+1],b[0]=k[D],b[1]=k[D+1];var V=E(G);if(e.defined(c))for(var x=V.length/3,S=c[D],I=0;I<x;++I)U[L++]=a.Color.floatToByte(S.red),U[L++]=a.Color.floatToByte(S.green),U[L++]=a.Color.floatToByte(S.blue),U[L++]=a.Color.floatToByte(S.alpha);M.set(V,v),v+=V.length}}else if(G.positions=y,G.height=k,M=new Float64Array(E(G)),e.defined(c)){for(U=new Uint8Array(M.length/3*4),D=0;D<_-1;++D)v=function(e,o,t,r,l,i,n){var s=f.PolylinePipeline.numberOfPoints(e,o,l),p=t.red,d=t.green,y=t.blue,c=t.alpha,u=r.red;e=r.green,o=r.blue,l=r.alpha;if(a.Color.equals(t,r)){for(b=0;b<s;b++)i[n++]=a.Color.floatToByte(p),i[n++]=a.Color.floatToByte(d),i[n++]=a.Color.floatToByte(y),i[n++]=a.Color.floatToByte(c);return n}for(var h=(u-p)/s,C=(e-d)/s,T=(o-y)/s,g=(l-c)/s,m=n,b=0;b<s;b++)i[m++]=a.Color.floatToByte(p+b*h),i[m++]=a.Color.floatToByte(d+b*C),i[m++]=a.Color.floatToByte(y+b*T),i[m++]=a.Color.floatToByte(c+b*g);return m}(y[D],y[D+1],c[D],c[D+1],T,U,v);var R=c[_-1];U[v++]=a.Color.floatToByte(R.red),U[v++]=a.Color.floatToByte(R.green),U[v++]=a.Color.floatToByte(R.blue),U[v++]=a.Color.floatToByte(R.alpha)}}else{var O=g?2*_-2:_,M=new Float64Array(3*O),U=e.defined(c)?new Uint8Array(4*O):void 0,N=0,F=0;for(D=0;D<_;++D){var H=y[D];if(g&&0<D&&(o.Cartesian3.pack(H,M,N),N+=3,S=c[D-1],U[F++]=a.Color.floatToByte(S.red),U[F++]=a.Color.floatToByte(S.green),U[F++]=a.Color.floatToByte(S.blue),U[F++]=a.Color.floatToByte(S.alpha)),g&&D===_-1)break;o.Cartesian3.pack(H,M,N),N+=3,e.defined(c)&&(S=c[D],U[F++]=a.Color.floatToByte(S.red),U[F++]=a.Color.floatToByte(S.green),U[F++]=a.Color.floatToByte(S.blue),U[F++]=a.Color.floatToByte(S.alpha))}}(R=new s.GeometryAttributes).position=new n.GeometryAttribute({componentDatatype:l.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:M}),e.defined(c)&&(R.color=new n.GeometryAttribute({componentDatatype:l.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:U,normalize:!0})),O=M.length/3;var W=p.IndexDatatype.createTypedArray(O,2*(O-1)),Y=0;for(D=0;D<O-1;++D)W[Y++]=D,W[Y++]=D+1;return new n.Geometry({attributes:R,indices:W,primitiveType:n.PrimitiveType.LINES,boundingSphere:r.BoundingSphere.fromPoints(y)})},function(t,r){return(t=e.defined(r)?g.unpack(t,r):t)._ellipsoid=o.Ellipsoid.clone(t._ellipsoid),g.createGeometry(t)}}));