define(["./when-208fe5b0","./Cartesian2-8417ca3d","./Transforms-a73b3b3b","./ComponentDatatype-9204e9f6","./Check-d18af7c4","./GeometryAttribute-04a19cfe","./GeometryAttributes-b0b294d8","./IndexDatatype-d47ad6f6","./Math-4e53b694","./WallGeometryLibrary-2a68d3dc","./RuntimeError-7f634f5d","./WebGLConstants-76bb35d1","./arrayRemoveDuplicates-0f62a181","./PolylinePipeline-28f5feec","./EllipsoidGeodesic-8015072b","./EllipsoidRhumbLine-28521929","./IntersectionTests-7d224a2f","./Plane-4aa8974d"],(function(e,i,t,a,n,r,o,s,l,d,m,u,p,f,h,c,g,y){"use strict";var _=new i.Cartesian3,E=new i.Cartesian3;function v(t){var a=(t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT)).positions,n=t.maximumHeights,r=t.minimumHeights,o=e.defaultValue(t.granularity,l.CesiumMath.RADIANS_PER_DEGREE);t=e.defaultValue(t.ellipsoid,i.Ellipsoid.WGS84);this._positions=a,this._minimumHeights=r,this._maximumHeights=n,this._granularity=o,this._ellipsoid=i.Ellipsoid.clone(t),this._workerName="createWallOutlineGeometry",a=1+a.length*i.Cartesian3.packedLength+2,e.defined(r)&&(a+=r.length),e.defined(n)&&(a+=n.length),this.packedLength=a+i.Ellipsoid.packedLength+1}v.pack=function(t,a,n){var r;n=e.defaultValue(n,0);var o=t._positions,s=o.length;for(a[n++]=s,r=0;r<s;++r,n+=i.Cartesian3.packedLength)i.Cartesian3.pack(o[r],a,n);var l=t._minimumHeights;s=e.defined(l)?l.length:0;if(a[n++]=s,e.defined(l))for(r=0;r<s;++r)a[n++]=l[r];var d=t._maximumHeights;if(s=e.defined(d)?d.length:0,a[n++]=s,e.defined(d))for(r=0;r<s;++r)a[n++]=d[r];return i.Ellipsoid.pack(t._ellipsoid,a,n),a[n+=i.Ellipsoid.packedLength]=t._granularity,a};var b=i.Ellipsoid.clone(i.Ellipsoid.UNIT_SPHERE),C={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:b,granularity:void 0};return v.unpack=function(t,a,n){a=e.defaultValue(a,0);for(var r,o,s=t[a++],l=new Array(s),d=0;d<s;++d,a+=i.Cartesian3.packedLength)l[d]=i.Cartesian3.unpack(t,a);if(0<(s=t[a++]))for(r=new Array(s),d=0;d<s;++d)r[d]=t[a++];if(0<(s=t[a++]))for(o=new Array(s),d=0;d<s;++d)o[d]=t[a++];var m=i.Ellipsoid.unpack(t,a,b),u=t[a+=i.Ellipsoid.packedLength];return e.defined(n)?(n._positions=l,n._minimumHeights=r,n._maximumHeights=o,n._ellipsoid=i.Ellipsoid.clone(m,n._ellipsoid),n._granularity=u,n):(C.positions=l,C.minimumHeights=r,C.maximumHeights=o,C.granularity=u,new v(C))},v.fromConstantHeights=function(i){var t=(i=e.defaultValue(i,e.defaultValue.EMPTY_OBJECT)).positions,a=i.minimumHeight,n=i.maximumHeight,r=e.defined(a),o=e.defined(n);if(r||o)for(var s=t.length,l=r?new Array(s):void 0,d=o?new Array(s):void 0,m=0;m<s;++m)r&&(l[m]=a),o&&(d[m]=n);return new v({positions:t,maximumHeights:d,minimumHeights:l,ellipsoid:i.ellipsoid})},v.createGeometry=function(n){var m=n._positions,u=n._minimumHeights,p=n._maximumHeights,f=n._granularity;n=n._ellipsoid,u=d.WallGeometryLibrary.computePositions(n,m,p,u,f,!1);if(e.defined(u)){var h=u.bottomPositions,c=u.topPositions,g=c.length,y=(f=2*g,new Float64Array(f)),v=0;for(g/=3,w=0;w<g;++w){var b=3*w,C=i.Cartesian3.fromArray(c,b,_);b=i.Cartesian3.fromArray(h,b,E);y[v++]=b.x,y[v++]=b.y,y[v++]=b.z,y[v++]=C.x,y[v++]=C.y,y[v++]=C.z}u=new o.GeometryAttributes({position:new r.GeometryAttribute({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:y})});for(var H=f/3,A=s.IndexDatatype.createTypedArray(H,f=2*H-4+H),k=0,w=0;w<H-2;w+=2){var G=w,L=w+2,x=i.Cartesian3.fromArray(y,3*G,_),P=i.Cartesian3.fromArray(y,3*L,E);i.Cartesian3.equalsEpsilon(x,P,l.CesiumMath.EPSILON10)||(x=w+3,A[k++]=P=w+1,A[k++]=G,A[k++]=P,A[k++]=x,A[k++]=G,A[k++]=L)}return A[k++]=H-2,A[k++]=H-1,new r.Geometry({attributes:u,indices:A,primitiveType:r.PrimitiveType.LINES,boundingSphere:new t.BoundingSphere.fromVertices(y)})}},function(t,a){return(t=e.defined(a)?v.unpack(t,a):t)._ellipsoid=i.Ellipsoid.clone(t._ellipsoid),v.createGeometry(t)}}));